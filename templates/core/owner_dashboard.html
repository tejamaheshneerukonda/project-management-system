<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Owner Dashboard - ProjectManager Pro</title>
    
    {% load static %}
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Owner Dashboard CSS -->
    <link href="{% static 'css/pages/owner.css' %}" rel="stylesheet">
    
    <style>
        .owner-header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .owner-brand {
            color: white !important;
            font-weight: 700;
            font-size: 1.5rem;
        }
        
        .owner-user-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            color: white;
        }
        
        .owner-footer {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 2rem 0;
            margin-top: auto;
        }
        
        .owner-stats-card {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
        }
        
        .owner-stats-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        /* Quick Actions Menu */
        .quick-actions {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 1rem;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        
        .quick-action-btn {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            margin: 0.25rem;
        }
        
        .quick-action-btn:hover {
            background: linear-gradient(135deg, #1e3a8a, #2563eb);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 8px 15px -3px rgba(0, 0, 0, 0.2);
        }
        
        .quick-action-btn.secondary {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        
        .quick-action-btn.secondary:hover {
            background: linear-gradient(135deg, #059669, #047857);
        }
        
        .quick-action-btn.info {
            background: linear-gradient(135deg, #06b6d4, #0891b2);
        }
        
        .quick-action-btn.info:hover {
            background: linear-gradient(135deg, #0891b2, #0e7490);
        }
        
        .border-left-primary {
            border-left: 0.25rem solid #1e40af !important;
        }
        
        .border-left-success {
            border-left: 0.25rem solid #10b981 !important;
        }
        
        .border-left-info {
            border-left: 0.25rem solid #06b6d4 !important;
        }
        
        .border-left-warning {
            border-left: 0.25rem solid #f59e0b !important;
        }
        
        .text-xs {
            font-size: 0.7rem;
        }
        
        .text-gray-300 {
            color: #6b7280 !important;
        }
        
        .text-gray-600 {
            color: #374151 !important;
        }
        
        .text-gray-800 {
            color: #1f2937 !important;
        }
        
        .company-key {
            background-color: #f3f4f6;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            color: #374151;
        }
        
        /* Company Table Enhancements */
        .company-table {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .table-header {
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            color: white;
            padding: 1rem 1.5rem;
            margin: 0;
        }
        
        .table th {
            background-color: #f8fafc;
            border-top: none;
            font-weight: 600;
            color: #374151;
        }
        
        .table td {
            vertical-align: middle;
            border-top: 1px solid #e5e7eb;
        }
        
        .status-badge {
            padding: 0.375rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-active {
            background-color: #d1fae5;
            color: #065f46;
        }
        
        .status-inactive {
            background-color: #fee2e2;
            color: #991b1b;
        }
        
        .action-btn {
            padding: 0.25rem 0.5rem;
            margin: 0.125rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
        }
        
        /* Enhanced Dropdown Menu Styling */
        .dropdown-menu {
            background: linear-gradient(135deg, #ffffff, #f8fafc);
            border: 1px solid #e2e8f0;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
            padding: 0.5rem 0;
            margin-top: 0.5rem;
            min-width: 220px;
        }
        
        .dropdown-item {
            padding: 0.75rem 1rem;
            color: #374151;
            transition: all 0.3s ease;
            border-radius: 0.5rem;
            margin: 0.125rem 0.5rem;
            display: flex;
            align-items: center;
        }
        
        .dropdown-item:hover {
            background: linear-gradient(135deg, rgba(30, 64, 175, 0.1), rgba(59, 130, 246, 0.1));
            color: #1e40af;
            transform: translateX(5px);
        }
        
        .dropdown-item i {
            width: 20px;
            text-align: center;
        }
        
        .dropdown-divider {
            margin: 0.5rem 0;
            border-color: #e2e8f0;
        }
        
        .dropdown-toggle::after {
            margin-left: 0.5rem;
            transition: transform 0.3s ease;
        }
        
        .dropdown-toggle[aria-expanded="true"]::after {
            transform: rotate(180deg);
        }
        
        /* Navbar Link Hover Effects */
        .navbar-nav .nav-link {
            position: relative;
            transition: all 0.3s ease;
            border-radius: 0.5rem;
            margin: 0 0.25rem;
        }
        
        .navbar-nav .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        
        .navbar-nav .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }
        
        /* Mobile Dropdown Enhancements */
        @media (max-width: 991.98px) {
            .dropdown-menu {
                position: static !important;
                transform: none !important;
                box-shadow: none;
                border: none;
                background: rgba(255, 255, 255, 0.1);
                margin: 0;
                border-radius: 0;
            }
            
            .dropdown-item {
                color: rgba(255, 255, 255, 0.8);
                margin: 0;
                border-radius: 0;
            }
            
            .dropdown-item:hover {
                background: rgba(255, 255, 255, 0.2);
                color: white;
                transform: none;
            }
        }
        
        /* Enhanced Features Styling - Light Colors */
        .bg-gradient-primary {
            background: linear-gradient(135deg, #3b82f6, #60a5fa) !important;
            color: white !important;
        }
        
        .bg-gradient-success {
            background: linear-gradient(135deg, #10b981, #34d399) !important;
            color: white !important;
        }
        
        .bg-gradient-info {
            background: linear-gradient(135deg, #06b6d4, #22d3ee) !important;
            color: white !important;
        }
        
        .bg-gradient-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24) !important;
            color: white !important;
        }
        
        .bg-gradient-secondary {
            background: linear-gradient(135deg, #6b7280, #9ca3af) !important;
            color: white !important;
        }
        
        .bg-gradient-danger {
            background: linear-gradient(135deg, #ef4444, #f87171) !important;
            color: white !important;
        }
        
        /* Progress Bar Enhancements */
        .progress {
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-bar {
            transition: width 0.6s ease;
        }
        
        /* Activity Feed Styling */
        .activity-item {
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .activity-item:hover {
            background-color: #f8fafc;
            border-left-color: #3b82f6;
        }
        
        /* Search Enhancement */
        .input-group .form-control:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 0.2rem rgba(59, 130, 246, 0.25);
        }
        
        /* Notification Styling */
        .list-group-item {
            border: none;
            border-bottom: 1px solid #e5e7eb;
            transition: all 0.3s ease;
        }
        
        .list-group-item:hover {
            background-color: #f8fafc;
        }
        
        .list-group-item:last-child {
            border-bottom: none;
        }
        
        /* Counter Animation */
        .counter-animate {
            animation: countUp 2s ease-out;
        }
        
        @keyframes countUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .card-body {
                padding: 1rem;
            }
            
            .h5, .h4, .h3 {
                font-size: 1.2rem;
            }
            
            .text-xs {
                font-size: 0.6rem;
            }
            
            .btn-group .btn {
                font-size: 0.7rem;
                padding: 0.25rem 0.5rem;
            }
            
            .table-responsive {
                font-size: 0.8rem;
            }
            
            .progress {
                height: 6px;
            }
        }
        
        /* Light Mode Enhancements */
        .card {
            background-color: #ffffff;
            border-color: #e5e7eb;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            background-color: #f8fafc;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .text-muted {
            color: #6b7280 !important;
        }
        
        .text-sm {
            color: #374151 !important;
        }
        
        /* Ensure all text is readable */
        .card-body {
            color: #1f2937;
        }
        
        .card-body h1, .card-body h2, .card-body h3, .card-body h4, .card-body h5, .card-body h6 {
            color: #1f2937;
        }
        
        .card-body p, .card-body span, .card-body div {
            color: #374151;
        }
    </style>
</head>
<body class="d-flex flex-column min-vh-100">
    {% load static %}
    
    <!-- Owner Header -->
    <header class="owner-header">
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container-fluid">
                <a class="navbar-brand owner-brand" href="{% url 'core:owner_dashboard' %}">
                    <i class="fas fa-crown me-2"></i>
                    ProjectManager Pro
                    <small class="d-block" style="font-size: 0.7rem; opacity: 0.8;">Owner Dashboard</small>
                </a>
                
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#ownerNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                
                <div class="collapse navbar-collapse" id="ownerNavbar">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'core:owner_dashboard' %}">
                                <i class="fas fa-tachometer-alt me-1"></i>Dashboard
                            </a>
                        </li>
                        
                        <!-- Company Management Dropdown -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-building me-1"></i>Companies
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'core:register_company' %}">
                                    <i class="fas fa-plus me-2"></i>Register New Company
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:all_companies' %}">
                                    <i class="fas fa-list me-2"></i>View All Companies
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:export_companies' %}">
                                    <i class="fas fa-download me-2"></i>Export Companies
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:company_analytics' %}">
                                    <i class="fas fa-chart-pie me-2"></i>Company Analytics
                                </a></li>
                            </ul>
                        </li>
                        
                        <!-- User Management Dropdown -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-users me-1"></i>Users
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'core:user_stats' %}">
                                    <i class="fas fa-chart-bar me-2"></i>User Statistics
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:active_users' %}">
                                    <i class="fas fa-user-check me-2"></i>Active Users
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:user_activity' %}">
                                    <i class="fas fa-history me-2"></i>User Activity
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:user_reports' %}">
                                    <i class="fas fa-file-alt me-2"></i>User Reports
                                </a></li>
                            </ul>
                        </li>
                        
                        <!-- Analytics Dropdown -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-chart-line me-1"></i>Analytics
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'core:system_stats' %}">
                                    <i class="fas fa-chart-bar me-2"></i>System Overview
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:revenue_reports' %}">
                                    <i class="fas fa-dollar-sign me-2"></i>Revenue Reports
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:growth_analytics' %}">
                                    <i class="fas fa-trending-up me-2"></i>Growth Analytics
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:owner_custom_reports' %}">
                                    <i class="fas fa-cog me-2"></i>Custom Reports
                                </a></li>
                            </ul>
                        </li>
                        
                        <!-- System Management Dropdown -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class="fas fa-cog me-1"></i>System
                            </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="{% url 'core:owner_system_settings' %}">
                                    <i class="fas fa-sliders-h me-2"></i>System Settings
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:owner_security_settings' %}">
                                    <i class="fas fa-shield-alt me-2"></i>Security
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:backup_restore' %}">
                                    <i class="fas fa-database me-2"></i>Backup & Restore
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:system_logs' %}">
                                    <i class="fas fa-file-alt me-2"></i>System Logs
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:audit_logs' %}">
                                    <i class="fas fa-history me-2"></i>Audit Trail
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'core:maintenance' %}">
                                    <i class="fas fa-tools me-2"></i>Maintenance
                                </a></li>
                            </ul>
                        </li>
                    </ul>
                    
                    <ul class="navbar-nav">
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle owner-user-info" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="fas fa-crown me-2"></i>{{ user.get_full_name|default:user.username }}
                                <small class="d-block" style="font-size: 0.7rem; opacity: 0.8;">
                                    {% if owner_profile.phone %}
                                        System Owner • {{ owner_profile.phone }}
                                    {% else %}
                                        System Owner
                                    {% endif %}
                                </small>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="{% url 'core:owner_dashboard' %}"><i class="fas fa-tachometer-alt me-2"></i>Dashboard</a></li>
                                <li><a class="dropdown-item" href="{% url 'core:register_company' %}"><i class="fas fa-building me-2"></i>Register Company</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:owner_profile_settings' %}"><i class="fas fa-user me-2"></i>Profile Settings</a></li>
                                <li><a class="dropdown-item" href="{% url 'core:owner_system_settings' %}"><i class="fas fa-cog me-2"></i>System Settings</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{% url 'core:logout' %}"><i class="fas fa-sign-out-alt me-2"></i>Logout</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="container-fluid">
        <main class="px-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Owner Dashboard</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <a href="{% url 'core:register_company' %}" class="btn btn-primary">
                            <i class="fas fa-plus me-2"></i>Register Company
                        </a>
                    </div>
                </div>
                
                <!-- Quick Actions Menu -->
                <div class="quick-actions">
                    <h5 class="mb-3 text-primary">
                        <i class="fas fa-bolt me-2"></i>Quick Actions
                    </h5>
                    <div class="d-flex flex-wrap">
                        <a href="{% url 'core:register_company' %}" class="quick-action-btn">
                            <i class="fas fa-building me-2"></i>Register New Company
                        </a>
                        <a href="{% url 'core:export_companies' %}" class="quick-action-btn secondary">
                            <i class="fas fa-download me-2"></i>Export Companies
                        </a>
                        <a href="#" class="quick-action-btn info" onclick="showSystemStats()">
                            <i class="fas fa-chart-bar me-2"></i>View Analytics
                        </a>
                        <a href="#" class="quick-action-btn secondary" onclick="refreshData()">
                            <i class="fas fa-sync-alt me-2"></i>Refresh Data
                        </a>
                    </div>
                </div>
                
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                {% endif %}
                
                <!-- Owner Profile Information -->
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                            <i class="fas fa-crown me-1"></i>System Owner Profile
                                        </div>
                                        <div class="h6 mb-1 font-weight-bold text-gray-800">
                                            {{ user.get_full_name|default:user.username }}
                                        </div>
                                        <div class="text-xs text-muted">
                                            <i class="fas fa-envelope me-1"></i>{{ user.email }}
                                            {% if owner_profile.phone %}
                                                • <i class="fas fa-phone me-1"></i>{{ owner_profile.phone }}
                                            {% endif %}
                                            • <i class="fas fa-calendar me-1"></i>Owner since {{ owner_profile.created_at|date:"M d, Y" }}
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <div class="bg-warning rounded-circle d-flex align-items-center justify-content-center" style="width: 60px; height: 60px;">
                                            <i class="fas fa-crown fa-2x text-white"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Enhanced Statistics Cards -->
                <div class="row mb-4">
                    <!-- Company Statistics -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-primary shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Total Companies</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_companies }}</div>
                                        <div class="text-xs text-success">
                                            <i class="fas fa-plus me-1"></i>{{ companies_growth }} new this month
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-building fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- User Statistics -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Total Users</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_users }}</div>
                                        <div class="text-xs text-success">
                                            <i class="fas fa-plus me-1"></i>{{ users_growth }} new this month
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-users fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Employee Statistics -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Total Employees</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_employees }}</div>
                                        <div class="text-xs text-info">
                                            {{ verification_rate }}% verified
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-tie fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Revenue Statistics -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Monthly Revenue</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">${{ monthly_revenue }}</div>
                                        <div class="text-xs text-warning">
                                            ${{ total_revenue }} projected annual
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-dollar-sign fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Secondary Statistics Row -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Active Companies</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ active_companies }}</div>
                                        <div class="text-xs text-muted">
                                            {{ inactive_companies }} inactive
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Company Admins</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_admins }}</div>
                                        <div class="text-xs text-info">
                                            {{ avg_employees_per_company }} avg employees/company
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-shield fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-primary shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">Verified Employees</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ verified_employees }}</div>
                                        <div class="text-xs text-primary">
                                            {{ unverified_employees }} pending verification
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-check fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Registered Users</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ registered_employees }}</div>
                                        <div class="text-xs text-warning">
                                            {{ unregistered_employees }} not registered
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-plus fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Subscription Statistics Row -->
                <div class="row mb-4">
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-success shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-success text-uppercase mb-1">Total Subscriptions</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ total_subscriptions }}</div>
                                        <div class="text-xs text-success">
                                            <i class="fas fa-credit-card me-1"></i>All subscription plans
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-credit-card fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-warning shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">Trial Subscriptions</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ trial_subscriptions }}</div>
                                        <div class="text-xs text-warning">
                                            <i class="fas fa-clock me-1"></i>14-day trial period
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-clock fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-danger shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-danger text-uppercase mb-1">Expired Subscriptions</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">{{ expired_subscriptions }}</div>
                                        <div class="text-xs text-danger">
                                            <i class="fas fa-exclamation-triangle me-1"></i>Require attention
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-exclamation-triangle fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="card border-left-info shadow h-100 py-2">
                            <div class="card-body">
                                <div class="row no-gutters align-items-center">
                                    <div class="col mr-2">
                                        <div class="text-xs font-weight-bold text-info text-uppercase mb-1">Subscription Revenue</div>
                                        <div class="h5 mb-0 font-weight-bold text-gray-800">${{ monthly_revenue }}</div>
                                        <div class="text-xs text-info">
                                            <i class="fas fa-chart-line me-1"></i>Real subscription data
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-chart-line fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mb-4">
                    <div class="col-12">
                        <div class="card shadow">
                            <div class="card-header">
                                <h6 class="m-0 font-weight-bold text-primary">Quick Actions</h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <a href="{% url 'core:register_company' %}" class="btn btn-outline-primary w-100">
                                            <i class="fas fa-building fa-2x mb-2"></i><br>
                                            Register Company
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="{% url 'core:subscription_plans' %}" class="btn btn-outline-success w-100">
                                            <i class="fas fa-credit-card fa-2x mb-2"></i><br>
                                            Subscription Plans
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="{% url 'core:company_subscriptions' %}" class="btn btn-outline-info w-100">
                                            <i class="fas fa-users fa-2x mb-2"></i><br>
                                            Subscriptions
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="{% url 'core:export_companies' %}" class="btn btn-outline-warning w-100">
                                            <i class="fas fa-download fa-2x mb-2"></i><br>
                                            Export Companies
                                        </a>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <button class="btn btn-outline-secondary w-100" onclick="refreshDashboard()">
                                            <i class="fas fa-sync-alt fa-2x mb-2"></i><br>
                                            Refresh Data
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <button class="btn btn-outline-dark w-100" onclick="showSystemSettings()">
                                            <i class="fas fa-cog fa-2x mb-2"></i><br>
                                            System Settings
                                        </button>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="{% url 'core:subscription_analytics' %}" class="btn btn-outline-primary w-100">
                                            <i class="fas fa-chart-bar fa-2x mb-2"></i><br>
                                            Subscription Analytics
                                        </a>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <a href="{% url 'core:all_companies' %}" class="btn btn-outline-success w-100">
                                            <i class="fas fa-list fa-2x mb-2"></i><br>
                                            All Companies
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- System Health & Activity Feed Row -->
                <div class="row mb-4">
                    <!-- System Health Monitoring -->
                    <div class="col-xl-6 mb-4">
                        <div class="card shadow h-100">
                            <div class="card-header bg-gradient-primary text-white">
                                <h6 class="m-0 font-weight-bold">
                                    <i class="fas fa-heartbeat me-2"></i>System Health
                                </h6>
                            </div>
                            <div class="card-body">
                                <!-- CPU Usage -->
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-1">
                                        <span class="text-sm font-weight-bold" style="color: #1f2937;">CPU Usage</span>
                                        <span class="text-sm" style="color: #374151;">{{ system_health.cpu_usage }}%</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-{% if system_health.cpu_usage < 50 %}success{% elif system_health.cpu_usage < 80 %}warning{% else %}danger{% endif %}" 
                                             style="width: {{ system_health.cpu_usage }}%"></div>
                                    </div>
                                </div>

                                <!-- Memory Usage -->
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-1">
                                        <span class="text-sm font-weight-bold" style="color: #1f2937;">Memory Usage</span>
                                        <span class="text-sm" style="color: #374151;">{{ system_health.memory_usage }}%</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-{% if system_health.memory_usage < 50 %}success{% elif system_health.memory_usage < 80 %}warning{% else %}danger{% endif %}" 
                                             style="width: {{ system_health.memory_usage }}%"></div>
                                    </div>
                                    <small style="color: #6b7280;">{{ system_health.memory_available }} GB available</small>
                                </div>

                                <!-- Disk Usage -->
                                <div class="mb-3">
                                    <div class="d-flex justify-content-between align-items-center mb-1">
                                        <span class="text-sm font-weight-bold" style="color: #1f2937;">Disk Usage</span>
                                        <span class="text-sm" style="color: #374151;">{{ system_health.disk_usage }}%</span>
                                    </div>
                                    <div class="progress" style="height: 8px;">
                                        <div class="progress-bar bg-{% if system_health.disk_usage < 50 %}success{% elif system_health.disk_usage < 80 %}warning{% else %}danger{% endif %}" 
                                             style="width: {{ system_health.disk_usage }}%"></div>
                                    </div>
                                    <small style="color: #6b7280;">{{ system_health.disk_free }} GB free</small>
                                </div>

                                <!-- System Status -->
                                <div class="text-center mt-3">
                                    <div class="badge bg-success p-2">
                                        <i class="fas fa-check-circle me-1"></i>System Online
                                    </div>
                                    <div class="badge bg-info p-2 ms-2">
                                        <i class="fas fa-clock me-1"></i>Uptime: 99.9%
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity Feed -->
                    <div class="col-xl-6 mb-4">
                        <div class="card shadow h-100">
                            <div class="card-header bg-gradient-success text-white">
                                <h6 class="m-0 font-weight-bold">
                                    <i class="fas fa-history me-2"></i>Recent Activity
                                </h6>
                            </div>
                            <div class="card-body" style="max-height: 400px; overflow-y: auto;">
                                {% if recent_activities %}
                                    {% for activity in recent_activities %}
                                        <div class="d-flex align-items-start mb-3">
                                            <div class="flex-shrink-0">
                                                <div class="bg-{{ activity.color }} rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                                    <i class="{{ activity.icon }} text-white"></i>
                                                </div>
                                            </div>
                                            <div class="flex-grow-1 ms-3">
                                                <h6 class="mb-1" style="color: #1f2937;">{{ activity.title }}</h6>
                                                <p class="text-sm mb-1" style="color: #374151;">{{ activity.description }}</p>
                                                <small style="color: #6b7280;">
                                                    <i class="fas fa-clock me-1"></i>{{ activity.timestamp|timesince }} ago
                                                </small>
                                            </div>
                                        </div>
                                    {% endfor %}
                                {% else %}
                                    <div class="text-center text-muted py-4">
                                        <i class="fas fa-inbox fa-3x mb-3"></i>
                                        <p>No recent activity</p>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Visualization Row -->
                <div class="row mb-4">
                    <!-- Growth Chart -->
                    <div class="col-xl-8 mb-4">
                        <div class="card shadow h-100">
                            <div class="card-header bg-gradient-info text-white">
                                <h6 class="m-0 font-weight-bold">
                                    <i class="fas fa-chart-line me-2"></i>Growth Analytics
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="text-center">
                                            <h4 class="text-primary">{{ companies_growth }}%</h4>
                                            <p class="text-muted mb-0">Company Growth (30 days)</p>
                                            <div class="progress mt-2" style="height: 6px;">
                                                <div class="progress-bar bg-primary" style="width: {{ companies_growth }}%"></div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="text-center">
                                            <h4 class="text-success">{{ users_growth }}%</h4>
                                            <p class="text-muted mb-0">User Growth (30 days)</p>
                                            <div class="progress mt-2" style="height: 6px;">
                                                <div class="progress-bar bg-success" style="width: {{ users_growth }}%"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <div class="bg-light p-4 rounded text-center">
                                        <i class="fas fa-chart-area fa-3x text-muted mb-3"></i>
                                        <p class="text-muted">Interactive charts will be displayed here</p>
                                        <small class="text-muted">Charts will show historical data trends</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quick Stats Widget -->
                    <div class="col-xl-4 mb-4">
                        <div class="card shadow h-100">
                            <div class="card-header bg-gradient-warning text-white">
                                <h6 class="m-0 font-weight-bold">
                                    <i class="fas fa-tachometer-alt me-2"></i>Quick Stats
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="row text-center">
                                    <div class="col-6 mb-3">
                                        <div class="border-end">
                                            <h5 class="text-primary mb-1">{{ recent_companies }}</h5>
                                            <small class="text-muted">New Companies</small>
                                        </div>
                                    </div>
                                    <div class="col-6 mb-3">
                                        <h5 class="text-success mb-1">{{ recent_users }}</h5>
                                        <small class="text-muted">New Users</small>
                                    </div>
                                    <div class="col-6">
                                        <div class="border-end">
                                            <h5 class="text-info mb-1">{{ verification_rate }}%</h5>
                                            <small class="text-muted">Verification Rate</small>
                                        </div>
                                    </div>
                                    <div class="col-6">
                                        <h5 class="text-warning mb-1">{{ avg_employees_per_company }}</h5>
                                        <small class="text-muted">Avg Employees</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Global Search & Notifications -->
                <div class="row mb-4">
                    <!-- Global Search -->
                    <div class="col-xl-6 mb-4">
                        <div class="card shadow">
                            <div class="card-header bg-gradient-secondary text-white">
                                <h6 class="m-0 font-weight-bold">
                                    <i class="fas fa-search me-2"></i>Global Search
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="input-group">
                                    <input type="text" class="form-control" placeholder="Search companies, users, employees..." id="globalSearch">
                                    <button class="btn btn-primary" type="button" onclick="performGlobalSearch()">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                                <div class="mt-3">
                                    <div class="btn-group" role="group">
                                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="filterByType('companies')">
                                            <i class="fas fa-building me-1"></i>Companies
                                        </button>
                                        <button type="button" class="btn btn-outline-success btn-sm" onclick="filterByType('users')">
                                            <i class="fas fa-users me-1"></i>Users
                                        </button>
                                        <button type="button" class="btn btn-outline-info btn-sm" onclick="filterByType('employees')">
                                            <i class="fas fa-user-tie me-1"></i>Employees
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Notifications Center -->
                    <div class="col-xl-6 mb-4">
                        <div class="card shadow">
                            <div class="card-header bg-gradient-danger text-white">
                                <h6 class="m-0 font-weight-bold">
                                    <i class="fas fa-bell me-2"></i>Notifications Center
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="list-group list-group-flush">
                                    <div class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-info-circle text-info me-2"></i>
                                            <span style="color: #1f2937;">System running smoothly</span>
                                        </div>
                                        <small style="color: #6b7280;">2 min ago</small>
                                    </div>
                                    <div class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                                            <span style="color: #1f2937;">{{ unverified_employees }} employees pending verification</span>
                                        </div>
                                        <small style="color: #6b7280;">1 hour ago</small>
                                    </div>
                                    <div class="list-group-item d-flex justify-content-between align-items-center">
                                        <div>
                                            <i class="fas fa-check-circle text-success me-2"></i>
                                            <span style="color: #1f2937;">{{ recent_companies }} new companies registered</span>
                                        </div>
                                        <small style="color: #6b7280;">3 hours ago</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Companies Table -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3 d-flex justify-content-between align-items-center">
                        <h6 class="m-0 font-weight-bold text-primary">Registered Companies</h6>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-sm btn-outline-primary" onclick="refreshCompanies()">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                            <a href="{% url 'core:export_companies' %}" class="btn btn-sm btn-outline-success">
                                <i class="fas fa-download"></i> Export
                            </a>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-bordered" id="companiesTable" width="100%" cellspacing="0">
                                <thead>
                                    <tr>
                                        <th>
                                            <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                                        </th>
                                        <th>Company Name</th>
                                        <th>Domain</th>
                                        <th>Admin</th>
                                        <th>Activation Key</th>
                                        <th>Status</th>
                                        <th>Employees</th>
                                        <th>Created</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for company in companies %}
                                    <tr>
                                        <td>
                                            <input type="checkbox" class="company-checkbox" value="{{ company.id }}">
                                        </td>
                                        <td>
                                            <strong>{{ company.name }}</strong>
                                            {% if not company.is_active %}
                                                <span class="badge bg-secondary ms-1">Inactive</span>
                                            {% endif %}
                                        </td>
                                        <td>{{ company.domain }}</td>
                                        <td>
                                            <div>
                                                {% if company.admin_user %}
                                                    <strong>{{ company.admin_user.get_full_name|default:company.admin_user.username }}</strong><br>
                                                    <small class="text-muted">{{ company.admin_user.email }}</small>
                                                {% else %}
                                                    <span class="text-muted">
                                                        <i class="fas fa-clock me-1"></i>Admin not registered yet
                                                    </span><br>
                                                    <small class="text-muted">Use company key to register</small>
                                                {% endif %}
                                            </div>
                                        </td>
                                        <td>
                                            {% if company.license_key %}
                                                <code class="company-key">{{ company.license_key }}</code>
                                                <button class="btn btn-sm btn-outline-secondary ms-1" onclick="copyToClipboard('{{ company.license_key }}')" title="Copy Activation Key">
                                                    <i class="fas fa-copy"></i>
                                                </button>
                                                {% if company.is_premium and company.is_license_valid %}
                                                    <span class="badge bg-success ms-1">Active</span>
                                                {% else %}
                                                    <span class="badge bg-warning ms-1">Expired</span>
                                                {% endif %}
                                            {% else %}
                                                <span class="text-muted">No license</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            {% if company.is_active %}
                                                <span class="badge bg-success">Active</span>
                                            {% else %}
                                                <span class="badge bg-danger">Inactive</span>
                                            {% endif %}
                                        </td>
                                        <td>
                                            <span class="badge bg-info">{{ company.employee_count }}</span>
                                            <small class="text-muted">/ {{ company.max_users }}</small>
                                        </td>
                                        <td>{{ company.created_at|date:"M d, Y" }}</td>
                                        <td>
                                            <div class="btn-group" role="group">
                                                <a href="{% url 'core:company_details' company.id %}" class="btn btn-sm btn-outline-primary" title="View Details">
                                                    <i class="fas fa-eye"></i>
                                                </a>
                                                <a href="{% url 'core:edit_company' company.id %}" class="btn btn-sm btn-outline-warning" title="Edit Company">
                                                    <i class="fas fa-edit"></i>
                                                </a>
                                                <a href="{% url 'core:toggle_company_status' company.id %}" class="btn btn-sm btn-outline-{% if company.is_active %}danger{% else %}success{% endif %}" title="{% if company.is_active %}Deactivate{% else %}Activate{% endif %} Company">
                                                    <i class="fas fa-{% if company.is_active %}pause{% else %}play{% endif %}"></i>
                                                </a>
                                                <button type="button" class="btn btn-sm btn-outline-danger" onclick="confirmDeleteCompany({{ company.id }}, '{{ company.name }}')" title="Delete Company">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    {% empty %}
                                    <tr>
                                        <td colspan="9" class="text-center text-muted">
                                            <i class="fas fa-building fa-3x mb-3 text-muted"></i><br>
                                            No companies registered yet.<br>
                                            <a href="{% url 'core:register_company' %}" class="btn btn-primary mt-2">
                                                <i class="fas fa-plus me-2"></i>Register First Company
                                            </a>
                                        </td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Bulk Actions -->
                <div class="row mb-4" id="bulkActions" style="display: none;">
                    <div class="col-12">
                        <div class="card shadow">
                            <div class="card-header bg-warning text-dark">
                                <h6 class="m-0 font-weight-bold">Bulk Actions</h6>
                            </div>
                            <div class="card-body">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-warning" onclick="bulkActivate()">
                                        <i class="fas fa-play me-2"></i>Activate Selected
                                    </button>
                                    <button type="button" class="btn btn-secondary" onclick="bulkDeactivate()">
                                        <i class="fas fa-pause me-2"></i>Deactivate Selected
                                    </button>
                                    <button type="button" class="btn btn-danger" onclick="bulkDelete()">
                                        <i class="fas fa-trash me-2"></i>Delete Selected
                                    </button>
                                </div>
                                <span class="ms-3 text-muted" id="selectedCount">0 companies selected</span>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Owner Footer -->
    <footer class="owner-footer mt-auto">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="fas fa-crown me-2"></i>ProjectManager Pro</h5>
                    <p class="mb-0">Professional project management system for enterprise companies.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="mb-2">
                        <small>
                            <i class="fas fa-crown me-1"></i>System Owner: {{ user.get_full_name|default:user.username }}
                            {% if owner_profile.phone %}
                                • <i class="fas fa-phone me-1"></i>{{ owner_profile.phone }}
                            {% endif %}
                        </small>
                    </div>
                    <div>
                        <small>&copy; 2024 ProjectManager Pro. All rights reserved.</small>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Owner Dashboard JS -->
    <script src="{% static 'js/pages/owner.js' %}"></script>
    
    <!-- Additional JavaScript for Quick Actions -->
    <script>
        // Quick Actions Functions
        function showSystemStats() {
            // Create a modal to show system statistics
            const modalHtml = `
                <div class="modal fade" id="systemStatsModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-chart-bar me-2"></i>System Analytics
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card border-primary">
                                            <div class="card-body text-center">
                                                <h3 class="text-primary">{{ total_companies|default:"0" }}</h3>
                                                <p class="mb-0">Total Companies</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card border-success">
                                            <div class="card-body text-center">
                                                <h3 class="text-success">{{ active_companies|default:"0" }}</h3>
                                                <p class="mb-0">Active Companies</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <div class="card border-info">
                                            <div class="card-body text-center">
                                                <h3 class="text-info">{{ total_users|default:"0" }}</h3>
                                                <p class="mb-0">Total Users</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card border-warning">
                                            <div class="card-body text-center">
                                                <h3 class="text-warning">{{ total_employees|default:"0" }}</h3>
                                                <p class="mb-0">Total Employees</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            // Remove existing modal if any
            const existingModal = document.getElementById('systemStatsModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            // Show modal
            const modal = new bootstrap.Modal(document.getElementById('systemStatsModal'));
            modal.show();
        }
        
        function refreshData() {
            // Show loading state
            const refreshBtn = event.target.closest('.quick-action-btn');
            const originalText = refreshBtn.innerHTML;
            refreshBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Refreshing...';
            refreshBtn.disabled = true;
            
            // Simulate refresh (in real app, this would make an AJAX call)
            setTimeout(() => {
                refreshBtn.innerHTML = originalText;
                refreshBtn.disabled = false;
                
                // Show success message
                showNotification('Data refreshed successfully!', 'success');
                
                // Reload the page to get fresh data
                window.location.reload();
            }, 1500);
        }
        
        function showNotification(message, type = 'info') {
            const alertHtml = `
                <div class="alert alert-${type} alert-dismissible fade show position-fixed" 
                     style="top: 20px; right: 20px; z-index: 9999; min-width: 300px;" role="alert">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'} me-2"></i>
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', alertHtml);
            
            // Auto-hide after 3 seconds
            setTimeout(() => {
                const alert = document.querySelector('.alert:last-of-type');
                if (alert) {
                    const bsAlert = new bootstrap.Alert(alert);
                    bsAlert.close();
                }
            }, 3000);
        }
        
        // Menu Functions
        function showAllCompanies() {
            showNotification('Redirecting to companies list...', 'info');
            // Scroll to companies table
            setTimeout(() => {
                document.querySelector('.company-table').scrollIntoView({ behavior: 'smooth' });
            }, 500);
        }
        
        function showCompanyAnalytics() {
            const modalHtml = `
                <div class="modal fade" id="companyAnalyticsModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header bg-primary text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-chart-pie me-2"></i>Company Analytics
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="card border-primary text-center">
                                            <div class="card-body">
                                                <h3 class="text-primary">{{ total_companies|default:"0" }}</h3>
                                                <p class="mb-0">Total Companies</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card border-success text-center">
                                            <div class="card-body">
                                                <h3 class="text-success">{{ active_companies|default:"0" }}</h3>
                                                <p class="mb-0">Active Companies</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card border-warning text-center">
                                            <div class="card-body">
                                                <h3 class="text-warning">{{ inactive_companies|default:"0" }}</h3>
                                                <p class="mb-0">Inactive Companies</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="card border-info text-center">
                                            <div class="card-body">
                                                <h3 class="text-info">{{ total_employees|default:"0" }}</h3>
                                                <p class="mb-0">Total Employees</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <h6>Company Growth Trend</h6>
                                    <div class="bg-light p-4 rounded text-center">
                                        <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
                                        <p class="text-muted">Growth analytics will be displayed here</p>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-primary">Export Report</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            showModal('companyAnalyticsModal', modalHtml);
        }
        
        function showUserStats() {
            const modalHtml = `
                <div class="modal fade" id="userStatsModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header bg-success text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-chart-bar me-2"></i>User Statistics
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="card border-primary">
                                            <div class="card-body text-center">
                                                <h3 class="text-primary">{{ total_users|default:"0" }}</h3>
                                                <p class="mb-0">Total Users</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card border-success">
                                            <div class="card-body text-center">
                                                <h3 class="text-success">{{ active_users|default:"0" }}</h3>
                                                <p class="mb-0">Active Users</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-md-6">
                                        <div class="card border-info">
                                            <div class="card-body text-center">
                                                <h3 class="text-info">{{ total_employees|default:"0" }}</h3>
                                                <p class="mb-0">Employees</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card border-warning">
                                            <div class="card-body text-center">
                                                <h3 class="text-warning">{{ total_admins|default:"0" }}</h3>
                                                <p class="mb-0">Company Admins</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            showModal('userStatsModal', modalHtml);
        }
        
        function showActiveUsers() {
            showNotification('Loading active users...', 'info');
            // In a real app, this would load active users data
        }
        
        function showUserActivity() {
            showNotification('Loading user activity logs...', 'info');
            // In a real app, this would load user activity data
        }
        
        function showUserReports() {
            showNotification('Generating user reports...', 'info');
            // In a real app, this would generate user reports
        }
        
        function showRevenueReports() {
            const modalHtml = `
                <div class="modal fade" id="revenueModal" tabindex="-1">
                    <div class="modal-dialog modal-xl">
                        <div class="modal-content">
                            <div class="modal-header bg-success text-white">
                                <h5 class="modal-title">
                                    <i class="fas fa-dollar-sign me-2"></i>Revenue Reports
                                </h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="card border-success text-center">
                                            <div class="card-body">
                                                <h3 class="text-success">$0</h3>
                                                <p class="mb-0">Monthly Revenue</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card border-primary text-center">
                                            <div class="card-body">
                                                <h3 class="text-primary">$0</h3>
                                                <p class="mb-0">Total Revenue</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="card border-info text-center">
                                            <div class="card-body">
                                                <h3 class="text-info">{{ total_companies|default:"0" }}</h3>
                                                <p class="mb-0">Paying Companies</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <h6>Revenue Trend</h6>
                                    <div class="bg-light p-4 rounded text-center">
                                        <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
                                        <p class="text-muted">Revenue charts will be displayed here</p>
                                    </div>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                <button type="button" class="btn btn-success">Export Revenue Report</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            showModal('revenueModal', modalHtml);
        }
        
        function showGrowthAnalytics() {
            showNotification('Loading growth analytics...', 'info');
            // In a real app, this would load growth analytics
        }
        
        function showCustomReports() {
            showNotification('Opening custom reports builder...', 'info');
            // In a real app, this would open custom reports builder
        }
        
        function showSystemSettings() {
            showNotification('Opening system settings...', 'info');
            // In a real app, this would open system settings
        }
        
        function showSecuritySettings() {
            showNotification('Opening security settings...', 'info');
            // In a real app, this would open security settings
        }
        
        function showBackupRestore() {
            showNotification('Opening backup & restore...', 'info');
            // In a real app, this would open backup & restore
        }
        
        function showSystemLogs() {
            showNotification('Loading system logs...', 'info');
            // In a real app, this would load system logs
        }
        
        function showMaintenance() {
            showNotification('Opening maintenance tools...', 'info');
            // In a real app, this would open maintenance tools
        }
        
        // Global Search Functions
        function performGlobalSearch() {
            const searchTerm = document.getElementById('globalSearch').value.trim();
            if (!searchTerm) {
                showNotification('Please enter a search term', 'warning');
                return;
            }
            
            showNotification(`Searching for "${searchTerm}"...`, 'info');
            // In a real app, this would perform actual search
            setTimeout(() => {
                showNotification(`Found 0 results for "${searchTerm}"`, 'info');
            }, 1000);
        }
        
        function filterByType(type) {
            showNotification(`Filtering by ${type}...`, 'info');
            // In a real app, this would filter the data
        }
        
        // System Health Functions
        function refreshSystemHealth() {
            showNotification('Refreshing system health data...', 'info');
            // In a real app, this would refresh system metrics
            setTimeout(() => {
                window.location.reload();
            }, 1500);
        }
        
        // Activity Feed Functions
        function refreshActivityFeed() {
            showNotification('Refreshing activity feed...', 'info');
            // In a real app, this would refresh activity data
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        }
        
        // Enhanced Statistics Functions
        function animateCounters() {
            // Disabled animation to prevent data display issues
            // Animation was interfering with correct data display
            console.log('Counter animation disabled to ensure accurate data display');
        }
        
        function animateCounter(element, start, end, duration, originalText) {
            const startTime = performance.now();
            const isNumber = /^\d+/.test(element.textContent);
            
            function updateCounter(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const current = Math.floor(start + (end - start) * progress);
                
                if (isNumber) {
                    element.textContent = current;
                } else {
                    // Replace the number in the original text
                    element.textContent = originalText.replace(/\d+/, current);
                }
                
                if (progress < 1) {
                    requestAnimationFrame(updateCounter);
                } else {
                    // Ensure final value is correct
                    element.textContent = originalText;
                }
            }
            
            requestAnimationFrame(updateCounter);
        }
        
        // Progress Bar Animations
        function animateProgressBars() {
            const progressBars = document.querySelectorAll('.progress-bar');
            progressBars.forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.transition = 'width 2s ease-in-out';
                    bar.style.width = width;
                }, 500);
            });
        }
        
        // Mobile Optimization
        function optimizeForMobile() {
            if (window.innerWidth < 768) {
                // Adjust layout for mobile
                const cards = document.querySelectorAll('.card');
                cards.forEach(card => {
                    card.classList.add('mb-3');
                });
                
                // Make tables responsive
                const tables = document.querySelectorAll('.table-responsive');
                tables.forEach(table => {
                    table.style.fontSize = '0.8rem';
                });
            }
        }
        
        // Real-time Updates Simulation
        function startRealTimeUpdates() {
            setInterval(() => {
                // Update system health (simulated)
                const cpuElement = document.querySelector('.progress-bar[style*="cpu"]');
                if (cpuElement) {
                    const currentWidth = parseInt(cpuElement.style.width);
                    const newWidth = Math.max(10, Math.min(90, currentWidth + (Math.random() - 0.5) * 10));
                    cpuElement.style.width = newWidth + '%';
                }
                
                // Update activity feed (simulated)
                const activityFeed = document.querySelector('.card-body[style*="max-height"]');
                if (activityFeed && Math.random() < 0.1) { // 10% chance every interval
                    const newActivity = document.createElement('div');
                    newActivity.className = 'd-flex align-items-start mb-3';
                    newActivity.innerHTML = `
                        <div class="flex-shrink-0">
                            <div class="bg-info rounded-circle d-flex align-items-center justify-content-center" style="width: 40px; height: 40px;">
                                <i class="fas fa-sync-alt text-white"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1" style="color: #1f2937;">System Update</h6>
                            <p class="text-sm mb-1" style="color: #374151;">System metrics updated</p>
                            <small style="color: #6b7280;">
                                <i class="fas fa-clock me-1"></i>Just now
                            </small>
                        </div>
                    `;
                    activityFeed.insertBefore(newActivity, activityFeed.firstChild);
                    
                    // Remove old activities if too many
                    const activities = activityFeed.querySelectorAll('.d-flex.align-items-start');
                    if (activities.length > 10) {
                        activities[activities.length - 1].remove();
                    }
                }
            }, 30000); // Update every 30 seconds
        }
        
        // Helper function to show modals
        function showModal(modalId, modalHtml) {
            // Remove existing modal if any
            const existingModal = document.getElementById(modalId);
            if (existingModal) {
                existingModal.remove();
            }
            
            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', modalHtml);
            
            // Show modal
            const modal = new bootstrap.Modal(document.getElementById(modalId));
            modal.show();
        }
        
        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Add hover effects to quick action buttons
            const quickActionBtns = document.querySelectorAll('.quick-action-btn');
            quickActionBtns.forEach(btn => {
                btn.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                });
                
                btn.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                });
            });
            
            // Add animation to stats cards
            const statsCards = document.querySelectorAll('.card');
            statsCards.forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    card.style.transition = 'all 0.5s ease';
                    card.style.opacity = '1';
                    card.style.transform = 'translateY(0)';
                }, index * 100);
            });
            
            // Add active state to current page
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });
            
            // Initialize new features
            setTimeout(() => {
                animateCounters();
                animateProgressBars();
                optimizeForMobile();
                startRealTimeUpdates();
            }, 1000);
            
            // Add refresh buttons to system health and activity feed
            const systemHealthCard = document.querySelector('.card-header:has(.fa-heartbeat)');
            if (systemHealthCard) {
                const refreshBtn = document.createElement('button');
                refreshBtn.className = 'btn btn-sm btn-outline-light ms-auto';
                refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i>';
                refreshBtn.onclick = refreshSystemHealth;
                refreshBtn.title = 'Refresh System Health';
                systemHealthCard.appendChild(refreshBtn);
            }
            
            const activityCard = document.querySelector('.card-header:has(.fa-history)');
            if (activityCard) {
                const refreshBtn = document.createElement('button');
                refreshBtn.className = 'btn btn-sm btn-outline-light ms-auto';
                refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i>';
                refreshBtn.onclick = refreshActivityFeed;
                refreshBtn.title = 'Refresh Activity Feed';
                activityCard.appendChild(refreshBtn);
            }
            
            // Add keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('globalSearch').focus();
                }
                if (e.ctrlKey && e.key === 'r') {
                    e.preventDefault();
                    refreshData();
                }
            });
            
            // Add tooltips
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });
        });
        
        // Copy to clipboard function
        function copyToClipboard(text) {
            // Use the modern Clipboard API if available
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(text).then(function() {
                    showCopySuccess();
                }).catch(function(err) {
                    console.error('Failed to copy: ', err);
                    fallbackCopyTextToClipboard(text);
                });
            } else {
                // Fallback for older browsers
                fallbackCopyTextToClipboard(text);
            }
        }
        
        function fallbackCopyTextToClipboard(text) {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            
            // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.position = "fixed";
            textArea.style.opacity = "0";
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess();
                } else {
                    showCopyError();
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                showCopyError();
            }
            
            document.body.removeChild(textArea);
        }
        
        function showCopySuccess() {
            const button = event.target.closest('button');
            const originalIcon = button.innerHTML;
            
            // Change icon to checkmark
            button.innerHTML = '<i class="fas fa-check text-success"></i>';
            button.classList.remove('btn-outline-secondary');
            button.classList.add('btn-outline-success');
            
            // Show tooltip
            button.setAttribute('title', 'Copied!');
            
            // Reset after 2 seconds
            setTimeout(function() {
                button.innerHTML = originalIcon;
                button.classList.remove('btn-outline-success');
                button.classList.add('btn-outline-secondary');
                button.setAttribute('title', 'Copy Key');
            }, 2000);
        }
        
        function showCopyError() {
            const button = event.target.closest('button');
            const originalIcon = button.innerHTML;
            
            // Change icon to error
            button.innerHTML = '<i class="fas fa-times text-danger"></i>';
            button.classList.remove('btn-outline-secondary');
            button.classList.add('btn-outline-danger');
            
            // Show tooltip
            button.setAttribute('title', 'Copy failed');
            
            // Reset after 2 seconds
            setTimeout(function() {
                button.innerHTML = originalIcon;
                button.classList.remove('btn-outline-danger');
                button.classList.add('btn-outline-secondary');
                button.setAttribute('title', 'Copy Key');
            }, 2000);
        }
    </script>
</body>
</html>
